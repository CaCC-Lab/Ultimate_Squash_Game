<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ‡ãƒ¢ - Phase 4: çµ±åˆã‚·ã‚¹ãƒ†ãƒ </title>
    <link rel="stylesheet" href="css/weekly-challenge.css">
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            color: white;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .demo-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .demo-header h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #4ecdc4, #45b7d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .demo-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .demo-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .demo-button {
            background: linear-gradient(45deg, #4ecdc4, #45b7d1);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.4);
        }
        
        .demo-button.danger {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
        }
        
        .demo-info {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid #4ecdc4;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .demo-log {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.9rem;
        }
        
        .game-simulator {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-input {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .stat-input label {
            font-weight: bold;
            color: #4ecdc4;
        }
        
        .stat-input input {
            padding: 8px;
            border: 1px solid #4ecdc4;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .status-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .status-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .status-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4ecdc4;
        }
        
        .status-label {
            font-size: 0.9rem;
            color: #b0b0b0;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸çµ±åˆã‚·ã‚¹ãƒ†ãƒ </h1>
            <p>Phase 4: å ±é…¬ã‚·ã‚¹ãƒ†ãƒ ã¨UIçµ±åˆã®ãƒ‡ãƒ¢</p>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ® ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h2>
            <div class="game-simulator">
                <div class="stat-input">
                    <label for="score">ã‚¹ã‚³ã‚¢</label>
                    <input type="number" id="score" value="0" min="0" max="10000">
                </div>
                <div class="stat-input">
                    <label for="hits">ãƒ’ãƒƒãƒˆæ•°</label>
                    <input type="number" id="hits" value="0" min="0" max="1000">
                </div>
                <div class="stat-input">
                    <label for="duration">æ™‚é–“ï¼ˆç§’ï¼‰</label>
                    <input type="number" id="duration" value="0" min="0" max="3600">
                </div>
                <div class="stat-input">
                    <label for="combo">æœ€å¤§ã‚³ãƒ³ãƒœ</label>
                    <input type="number" id="combo" value="0" min="0" max="100">
                </div>
            </div>
            
            <div class="demo-controls">
                <button class="demo-button" onclick="startGameSession()">ğŸ® ã‚²ãƒ¼ãƒ é–‹å§‹</button>
                <button class="demo-button" onclick="updateGameState()">ğŸ“Š çŠ¶æ…‹æ›´æ–°</button>
                <button class="demo-button" onclick="endGameSession()">ğŸ ã‚²ãƒ¼ãƒ çµ‚äº†</button>
                <button class="demo-button danger" onclick="simulateChallenge()">ğŸ† ãƒãƒ£ãƒ¬ãƒ³ã‚¸å®Œäº†</button>
            </div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ“Š ãƒãƒ£ãƒ¬ãƒ³ã‚¸çŠ¶æ…‹</h2>
            <div class="status-display">
                <div class="status-item">
                    <div class="status-value" id="challenge-title">-</div>
                    <div class="status-label">ãƒãƒ£ãƒ¬ãƒ³ã‚¸</div>
                </div>
                <div class="status-item">
                    <div class="status-value" id="challenge-progress">0%</div>
                    <div class="status-label">é€²æ—</div>
                </div>
                <div class="status-item">
                    <div class="status-value" id="challenge-status">å¾…æ©Ÿä¸­</div>
                    <div class="status-label">çŠ¶æ…‹</div>
                </div>
                <div class="status-item">
                    <div class="status-value" id="reward-points">0</div>
                    <div class="status-label">ç²å¾—ãƒã‚¤ãƒ³ãƒˆ</div>
                </div>
            </div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ”§ ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½</h2>
            <div class="demo-controls">
                <button class="demo-button" onclick="toggleDebugMode()">ğŸ› ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿</button>
                <button class="demo-button" onclick="resetProgress()">ğŸ”„ é€²æ—ãƒªã‚»ãƒƒãƒˆ</button>
                <button class="demo-button" onclick="showChallengeInfo()">â„¹ï¸ ãƒãƒ£ãƒ¬ãƒ³ã‚¸æƒ…å ±</button>
                <button class="demo-button" onclick="simulateCompletion()">âš¡ å®Œäº†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</button>
            </div>
            
            <div class="demo-info">
                <strong>ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰:</strong> <span id="debug-status">ç„¡åŠ¹</span>
            </div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ“ ãƒ­ã‚°</h2>
            <div class="demo-log" id="log-output">
                ã‚·ã‚¹ãƒ†ãƒ æº–å‚™ä¸­...
            </div>
        </div>
    </div>
    
    <!-- ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script src="js/challenge-types.js"></script>
    <script src="js/challenge-generator.js"></script>
    <script src="js/challenge-evaluator.js"></script>
    <script src="js/challenge-rewards.js"></script>
    <script src="js/weekly-challenge.js"></script>
    <script src="js/weekly-challenge-integration.js"></script>
    
    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let challengeIntegration;
        let gameSimulator;
        
        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼
        class GameStateSimulator {
            constructor() {
                this.state = {
                    score: 0,
                    hits: 0,
                    duration: 0,
                    maxCombo: 0,
                    ballSpeed: 5,
                    paddleSize: 100,
                    isGameOver: false
                };
            }
            
            updateFromInputs() {
                this.state.score = parseInt(document.getElementById('score').value) || 0;
                this.state.hits = parseInt(document.getElementById('hits').value) || 0;
                this.state.duration = parseInt(document.getElementById('duration').value) || 0;
                this.state.maxCombo = parseInt(document.getElementById('combo').value) || 0;
            }
            
            getState() {
                return { ...this.state };
            }
        }
        
        // ãƒ­ã‚°å‡ºåŠ›
        function log(message) {
            const logOutput = document.getElementById('log-output');
            const timestamp = new Date().toLocaleTimeString();
            logOutput.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            logOutput.scrollTop = logOutput.scrollHeight;
        }
        
        // çŠ¶æ…‹è¡¨ç¤ºæ›´æ–°
        function updateStatusDisplay() {
            if (!challengeIntegration) return;
            
            const challenge = challengeIntegration.getCurrentChallenge();
            const stats = challengeIntegration.getChallengeStats();
            
            document.getElementById('challenge-title').textContent = challenge ? challenge.title : '-';
            document.getElementById('challenge-progress').textContent = 
                Math.round(stats.progress.progress || 0) + '%';
            document.getElementById('challenge-status').textContent = 
                stats.session ? 'ãƒ—ãƒ¬ã‚¤ä¸­' : (stats.progress.completed ? 'å®Œäº†' : 'å¾…æ©Ÿä¸­');
            document.getElementById('reward-points').textContent = 
                stats.progress.reward ? stats.progress.reward.points : 0;
        }
        
        // ã‚²ãƒ¼ãƒ æ©Ÿèƒ½
        function startGameSession() {
            if (!challengeIntegration) {
                log('âŒ çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }
            
            gameSimulator.updateFromInputs();
            challengeIntegration.startGameSession(gameSimulator.getState());
            updateStatusDisplay();
            log('ğŸ® ã‚²ãƒ¼ãƒ ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã¾ã—ãŸ');
        }
        
        function updateGameState() {
            if (!challengeIntegration || !challengeIntegration.gameSession) {
                log('âŒ ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚²ãƒ¼ãƒ ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã›ã‚“');
                return;
            }
            
            gameSimulator.updateFromInputs();
            challengeIntegration.updateGameState(gameSimulator.getState());
            updateStatusDisplay();
            log('ğŸ“Š ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
        }
        
        function endGameSession() {
            if (!challengeIntegration) {
                log('âŒ çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }
            
            gameSimulator.state.isGameOver = true;
            challengeIntegration.updateGameState(gameSimulator.getState());
            updateStatusDisplay();
            log('ğŸ ã‚²ãƒ¼ãƒ ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’çµ‚äº†ã—ã¾ã—ãŸ');
        }
        
        function simulateChallenge() {
            // é«˜ã‚¹ã‚³ã‚¢è¨­å®š
            document.getElementById('score').value = '2000';
            document.getElementById('hits').value = '100';
            document.getElementById('duration').value = '180';
            document.getElementById('combo').value = '15';
            
            // ã‚²ãƒ¼ãƒ çŠ¶æ…‹æ›´æ–°
            updateGameState();
            log('ğŸ† ãƒãƒ£ãƒ¬ãƒ³ã‚¸å®Œäº†ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ã¾ã—ãŸ');
        }
        
        // ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½
        function toggleDebugMode() {
            if (WeeklyChallengeDebug.isDebugMode()) {
                WeeklyChallengeDebug.disableDebugMode();
                document.getElementById('debug-status').textContent = 'ç„¡åŠ¹';
                log('ğŸ› ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹ã«ã—ã¾ã—ãŸ');
            } else {
                WeeklyChallengeDebug.enableDebugMode();
                document.getElementById('debug-status').textContent = 'æœ‰åŠ¹';
                log('ğŸ› ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ã¾ã—ãŸ');
            }
        }
        
        function resetProgress() {
            if (!challengeIntegration) return;
            
            challengeIntegration.challengeProgress = { progress: 0, completed: false };
            challengeIntegration.saveChallengeProgress();
            updateStatusDisplay();
            log('ğŸ”„ é€²æ—ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
        }
        
        function showChallengeInfo() {
            if (!challengeIntegration) return;
            
            const challenge = challengeIntegration.getCurrentChallenge();
            const info = `
                ID: ${challenge.id}
                ã‚¿ã‚¤ãƒˆãƒ«: ${challenge.title}
                èª¬æ˜: ${challenge.description}
                ã‚¿ã‚¤ãƒ—: ${challenge.type}
                ç›®æ¨™: ${challenge.target}
                å ±é…¬: ${challenge.reward.points}pt
            `;
            log(`â„¹ï¸ ãƒãƒ£ãƒ¬ãƒ³ã‚¸æƒ…å ±:\n${info}`);
        }
        
        function simulateCompletion() {
            if (!challengeIntegration) return;
            
            WeeklyChallengeDebug.simulateChallengeCompletion(challengeIntegration);
            updateStatusDisplay();
            log('âš¡ ãƒãƒ£ãƒ¬ãƒ³ã‚¸å®Œäº†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã—ãŸ');
        }
        
        // åˆæœŸåŒ–
        function initialize() {
            try {
                gameSimulator = new GameStateSimulator();
                challengeIntegration = new WeeklyChallengeIntegration();
                
                // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
                challengeIntegration.addListener((event, data) => {
                    log(`ğŸ“¢ ã‚¤ãƒ™ãƒ³ãƒˆ: ${event} - ${JSON.stringify(data).substring(0, 100)}...`);
                    updateStatusDisplay();
                });
                
                updateStatusDisplay();
                log('âœ… ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ');
                
            } catch (error) {
                log(`âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                console.error('åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>